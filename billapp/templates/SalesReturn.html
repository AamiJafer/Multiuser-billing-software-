{% extends 'base.html' %}
{% load static %}
{% block content %}

<style>
    input {
        background-color: black;
        color: white;
    }

    .input_border {
        border: 1px solid #68020F;
    }
    .form-control{
        border:1px solid #68020F;
    }
    a {
        text-decoration: none;
    }

    .nav {
        background-color: rgba(241, 210, 210, 0.5);
    }

    .nav-link {
        font-size: 15px;
        margin-right: 19px;
        color: rgb(130, 127, 127);
        margin-left: -3%;
        font-weight: bold;
    }

    .tab-pan {
        background-color: rgb(130, 127, 127);
    }

    .button_border {
        border: 1px solid #68020F;
        color: #68020F;
    }

    .button_border:hover {
        background-color: #68020F;
        color: white;
    }
    thead {
            background-color: #68020F; 
            color: #fff; 
        }

    .tab-pane{
        display: none;
    }

</style>
<div class="body-wrapper">
    <div class="container">
        <br><br><br><br><br><br><br>
        <div class="p-3" style="border: 2px solid #68020F; border-radius: 2.5vh; background-color: #FFD6D7;">
            <div class="card-body">
                <form class="row g-3">
                    <div class="row mt-3">
                    <div class="col-md-4">
                        <label for="" class="form-label">Party Name</label>
                        <div style="display: flex;">
                            <div class="myDropDown">
                                <select id="party_name" class="form-control" name="party_name">
                                    <option value="" selected disabled>Select a party name</option>
                                    {% for party in parties %}
                                    <option value="{{ party.id }}" data-phone="{{ party.phone }}"
                                    data-invoice="{{ party.sales_invoice.invoice_number }}"
                                    data-invoice-date="{{ party.sales_invoice.invoice_date }}">{{ party.party_name }}</option>
                                    {% endfor %}
                                </select>
                            </div>
                            <div class="btn-group" role="group" aria-label="Third group" style="margin-left: 5px;">
                                <button type="button" class="btn button_border" data-bs-toggle="modal"
                                    data-bs-target="#unitmodal" data-bs-whatever="@mdo"
                                    onclick="showModal(); openDefaultPage();">
                                    <span class="fa fa-plus"></span>
                                </button>
                            </div>

                        </div>
                    </div>
                    <div class="col-md-4">
                        <label for="" class="form-label">Phone Number</label>
                        <input type="text" class="form-control" id="party_phone" name="party_phone">
                    </div>
                    <div class="col-md-4">
                        <label for="validationDefaultUsername" class="form-label">Reference Number</label>
                        <input type="text" class="form-control" id="" name="refnum">
                    </div>
                </div>
                    <div class="row mt-3" style="display: block;">
                    <div class="col-md-4">
                        <label for="validationDefaultUsername" class="form-label">Invoice Number</label>
                        <input type="text" class="form-control" id="invoiceno" name="invoiceno">
                    </div>
                    
                    <div class="col-md-4">
                        <label for="validationDefaultUsername" class="form-label">Invoice Date</label>
                        <input type="date" class="form-control" id="invoicedate" name="invoicedate">
                    </div>
                </div>
                    <div class="row mt-3">
                    <div class="col-md-4">
                        <label for="validationDefaultUsername" class="form-label">Return Date</label>
                        <input type="date" class="form-control" id="" name="returndate">
                    </div>
                    <div class="col-md-4">
                        <label for="validationDefaultUsername" class="form-label">Place of Supply</label>
                        <input type="text" class="form-control" id="" name="placesupply">
                    </div>
                    <div class="col-md-4">
                        <label for="validationDefaultUsername" class="form-label">Payment method</label>
                        <input type="text" class="form-control" id="" name="paymethod">
                    </div>
                </div>
                    <div class="table-responsive">
                        <table class="table table-bordered table-sm mt-3" style="text-align: center;">
                            <thead>
                                <tr>
                                    <th>#</th>
                                    <th>PRODUCT</th>
                                    <th>HSN</th>
                                    <th>QTY</th>
                                    <th>PRICE</th>
                                    <th>TAX</th>
                                    <th>DISCOUNT</th>
                                    <th>TOTAL</th>
                                    <th>FIELD</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr></tr>
                            </tbody>
                    
                    </div>
                    <div class="modal fade" id="unitmodal" tabindex="-1" aria-labelledby="exampleModalLabel"
                        aria-hidden="true">
                        <div class="modal-dialog modal-lg">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h1 class="modal-title fs-5" id="exampleModalLabel"
                                        style="color: #68020F; font-weight: 900;">ADD PARTY</h1>
                                    <button type="button" class="btn-close" data-bs-dismiss="modal"
                                        aria-label="Close"></button>
                                </div>
                                <div class="container">
                                    <div class="modal-body mb-1 pb-1">
                                        <div class="container-fluid">
                                            <form id="unitmodalform" action="{% url 'saveParty' %}" method="POST" enctype="multipart/form-data">
                                                {% csrf_token %}
                                                <div class="form-group row">
                                                    <div class="col-md-4">
                                                        <label for="party_name" class="col-form-label">PARTY
                                                            NAME</label>
                                                        <input type="text" class="form-control _border" id=""
                                                            placeholder="Enter Party Name"
                                                            style="border: 2px solid #68020F;" name='party_name'>
                                                    </div>
                                                    <div class="col-md-4">
                                                        <label for="party_address"
                                                            class="col-form-label">GSTIN</label>
                                                        <input type="text" class="form-control _border" id=""
                                                            placeholder="29APPCK7465F1Z1"
                                                            style="border: 2px solid #68020F;" name='gst_no'>
                                                    </div>
                                                    <div class="col-md-4">
                                                        <label for="party_name" class="col-form-label">MOBILE</label>
                                                        <input type="text" class="form-control _border" id=""
                                                            placeholder="Enter Mobile Number"
                                                            style="border: 2px solid #68020F;" name='party_num'>
                                                    </div>
                                                </div>
                                                <div class="tabContainer">
                                                <ul class="nav nav-pills nav-fill mt-3" id="myTabs">
                                                    <li class="nav-item">
                                                        <button type="button" class="nav-link" id="defaultOpen"
                                                            onclick="showPanel(0)">GST & ADDRESS</button>

                                                    </li>
                                                    <li class="nav-item">
                                                        <button type="button" class="nav-link" id="creditTab"
                                                        onclick="showPanel(1)">CREDIT & BALANCES</button>

                                                    </li>
                                                    <li class="nav-item">
                                                        <button type="button" class="nav-link" id="balancesTab"
                                                        onclick="showPanel(2)">ADDITIONAL FIELD</button>
                                                    </li>
                                                </ul>
                                                <div id="transactionForm" class="tab-pane p-3" style="margin-top: 3%;">
                                                    <div class="form-group row">
                                                        <div class="col-md-6">
                                                        <div>
                                                            <label for="state" class="col-form-label">GST Type</label>

                                                            <select class="form-control" name="gsttype" id="gsttype" required>
                                                                <option selected hidden value="">Select GST Type</option>
                                                                <option value="Registered Business - Regular"> Registered Business - Regular </option>
                                                                <option value="Registered Business - Composition"> Registered Business - Composition </option>
                                                                <option value="unregistered Business"> Unregistered Business </option>
                                                                <option value="Consumer">Consumer</option>
                                                                <option value="Overseas">Oversears </option>
                                                            </select>
                                                        </div><br>
                                                        <div>
                                                            <label for="state" class="col-form-label">Supply State</label>
                                                            <input type="text" class="form-control _border" id=""
                                                                placeholder="Enter State"
                                                                style="border: 2px solid #68020F;" name='supp_state'>
                                                        </div><br>
                                                        <div>
                                                            <label for="email" class="col-form-label">Email</label>
                                                            <input type="email" class="form-control _border" id=""
                                                                placeholder="Enter EmailId"
                                                                style="border: 2px solid #68020F;" name='email'>
                                                        </div>
                                                        </div>
                                                        <div class="col-md-6">
                                                        <div>
                                                            <label for="address" class="col-form-label">Billing Address</label>
                                                            <textarea class="form-control _border" id="" placeholder="Enter Party Address"
                                                                style="border: 2px solid #68020F;" rows="6" name="party_addr"></textarea>
                                                        

                                                        </div>
                                                        </div>
                                                    </div>    
                                                       
                                                           
                                                      
                                        
                                                    <div class="col-md-12 d-flex justify-content-start mt-5">

                                                        <button type="button" class="btn button_border me-3" onclick="showPanel(1)">NEXT</button>


                                                    </div>

                                                </div>

                                                <div id="creditForm" class="tab-pane p-3" style="margin-top: 3%;">
                                                    <div class="row">
                                                        <div class="col-md-4">
                                                            <label for="bal" class="col-form-label">Opening Balance</label></div>
                                                        <div class="col-md-4 mt-2">
                                                            <input type="radio" name="paymentType" value="toReceive" checked>
                                                                To Receive
                                                        </div>
                                                        <div class="col-md-4 mt-2">
                                                            <input type="radio" name="paymentType" value="toPay" checked>
                                                                To Pay
                                                        </div>
                                                    </div><br>
                                                    <div class="row">
                                                        <div class="col-md-6">
                                                            
                                                            <input type="number" class="form-control _border" id=""
                                                                placeholder=""
                                                                style="border: 2px solid #68020F; margin-top: 40px;" name='creditamt'>
                                                        </div>
                                                        <div class="col-md-6">
                                                            <label for="creditLimit" class="col-form-label">Credit Limit</label>
                                                            <input type="number" class="form-control _border" id=""
                                                                placeholder=""
                                                                style="border: 2px solid #68020F;" name='crLimit'>
                                                        </div>
                                                    </div><br>
                                                    <div class="row">
                                                        <div class="col-md-6">
                                                            <label for="date" class="col-form-label">Date</label>
                                                            <input type="date" class="form-control _border" id=""
                                                                placeholder=""
                                                                style="border: 2px solid #68020F;" name='credit_date'>
                                                        </div>
                                                    </div><br>
                                                    <div class="col-md-12 d-flex justify-content-start mt-3">

                                                        <button type="button" class="btn button_border me-3" onclick="showPanel(0)">PREVIOUS</button>
                                                        <button type="button" class="btn button_border me-3" onclick="showPanel(2)">NEXT</button>

                                                    </div>
                                                </div>

                                                <div id="balancesForm" class="tab-pane p-3" style="margin-top: 3%;">
                                                    <div class="row">
                                                        <div class="col-md-4">
                                                            <label for="add1" class="col-form-label">Additional Field1</label>
                                                            <input type="text" class="form-control _border" id=""
                                                                placeholder=""
                                                                style="border: 2px solid #68020F;" name='addField1'>
                                                        </div>
                                                        <div class="col-md-4">
                                                            <label for="add2" class="col-form-label">Additional Field2</label>
                                                            <input type="text" class="form-control _border" id=""
                                                                placeholder=""
                                                                style="border: 2px solid #68020F;" name='addField2'>
                                                        </div>
                                                        <div class="col-md-4">
                                                            <label for="add3" class="col-form-label">Additional Field3</label>
                                                            <input type="text" class="form-control _border" id=""
                                                                placeholder=""
                                                                style="border: 2px solid #68020F;" name='addField3'>
                                                        </div>
                                                        <div class="col-md-12 d-flex justify-content-start mt-5">

                                                            <button type="button" class="btn button_border me-3" onclick="showPanel(1)">PREVIOUS</button>
                                                            <button type="submit" class="btn button_border me-3">SAVE</button>
    
                                                        </div>

                                                    </div>
                                                </div>
                                                </div>
                                            </form>

                                        </div>
                                    </div>
                                </div>

                            </div>
                        </div>
                    </div>

                </form>
            </div>

        </div>
    </div>
</div>
<script>

    // function openPage(pageName) {
    //     var tabcontent, i;
    //     tabcontent = document.getElementsByClassName("tab-pane");
    //     for (i = 0; i < tabcontent.length; i++) {
    //         tabcontent[i].style.display = "none";
    //     }
    //     document.getElementById(pageName).style.display = "block"; 
    // }

    var tabButtons=document.querySelectorAll(".tabContainer .nav .nav-item button");
    var tabPanels=document.querySelectorAll(".tabContainer .tab-pane");

    function showPanel(panelIndex){
        tabButtons.forEach(function(node){
            node.style.backgroundColor="";
            node.style.color="";
        });
        tabButtons[panelIndex].style.backgroundColor= "#68020F";
        tabButtons[panelIndex].style.color= "white";
        tabPanels.forEach(function(node){
            node.style.display="none";
        });
        tabPanels[panelIndex].style.display="block";
    }
    showPanel(0);










    
    // function openDefaultPage() {
    //     document.getElementById("defaultOpen").click();
    // }

    // document.getElementById('party_name').addEventListener('change', function () {
    //     var selectedOption = this.options[this.selectedIndex];
        
       
    //     var phone = selectedOption.getAttribute('data-phone');
    //     document.getElementById('party_phone').value = phone || '';
        
       
    //     var invoiceno = selectedOption.getAttribute('data-invoice');
    //     document.getElementById('invoiceno').value = invoiceno || '';
        
       
    //     var invoicedate = selectedOption.getAttribute('data-invoice-date');
    //     document.getElementById('invoicedate').value = invoicedate || '';
        
       
    // });
</script>
{% endblock %}